# CPSE n8n ìš´ì˜ ë§¤ë‰´ì–¼

## ğŸ“‹ ë§¤ë‰´ì–¼ ì •ë³´
- **ì„œë¹„ìŠ¤ëª…**: n8n ì›Œí¬í”Œë¡œìš° ìë™í™”
- **ë²„ì „**: 1.0
- **ìƒì„±ì¼**: 2025-07-07 12:11:42
- **ëŒ€ìƒ í™˜ê²½**: ì‹œë†€ë¡œì§€ DS920+ NAS

## ğŸš€ ì„œë¹„ìŠ¤ ì‹œì‘ ë° ì¤‘ì§€

### ì„œë¹„ìŠ¤ ì‹œì‘
```bash
# SSHë¡œ NAS ì ‘ì†
ssh -p 22022 crossman@192.168.0.5

# n8n ì»¨í…Œì´ë„ˆ ì‹œì‘
sudo docker start cpse_n8n

# ìƒíƒœ í™•ì¸
sudo docker ps | grep cpse_n8n
```

### ì„œë¹„ìŠ¤ ì¤‘ì§€
```bash
# n8n ì»¨í…Œì´ë„ˆ ì¤‘ì§€
sudo docker stop cpse_n8n

# ê°•ì œ ì¤‘ì§€ (í•„ìš”ì‹œ)
sudo docker kill cpse_n8n
```

### ì„œë¹„ìŠ¤ ì¬ì‹œì‘
```bash
# ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
sudo docker restart cpse_n8n

# ë¡œê·¸ í™•ì¸
sudo docker logs cpse_n8n --tail 100
```

## ğŸ”§ ì´ˆê¸° ì„¤ì¹˜ ì ˆì°¨

### 1ë‹¨ê³„: í™˜ê²½ ì¤€ë¹„
```bash
# ë°ì´í„° ë””ë ‰í† ë¦¬ ìƒì„±
sudo mkdir -p /volume1/docker/n8n
sudo chown -R crossman:users /volume1/docker/n8n

# ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì •ë¦¬ (í•„ìš”ì‹œ)
sudo docker stop n8n 2>/dev/null || true
sudo docker rm n8n 2>/dev/null || true
```

### 2ë‹¨ê³„: ì»¨í…Œì´ë„ˆ ìƒì„± ë° ì‹¤í–‰
```bash
sudo docker run -d \
  --name cpse_n8n \
  --restart unless-stopped \
  -p 5678:5678 \
  -v /volume1/docker/n8n:/home/node/.n8n \
  -e N8N_BASIC_AUTH_ACTIVE=true \
  -e N8N_BASIC_AUTH_USER=crossman \
  -e N8N_BASIC_AUTH_PASSWORD=changeme123 \
  -e N8N_HOST=n8n.crossman.synology.me \
  -e N8N_PORT=5678 \
  -e N8N_PROTOCOL=https \
  -e WEBHOOK_URL=https://n8n.crossman.synology.me \
  n8nio/n8n:latest
```

### 3ë‹¨ê³„: ì ‘ì† í™•ì¸
```bash
# ë‚´ë¶€ ì ‘ì† í…ŒìŠ¤íŠ¸
curl -u crossman:changeme123 http://192.168.0.5:5678

# ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸
sudo docker logs cpse_n8n
```

## ğŸŒ ì„œë¸Œë„ë©”ì¸ ì„¤ì •

### DSM ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì •
1. **DSM ê´€ë¦¬ì ë¡œê·¸ì¸**: https://192.168.0.5:5001
2. **ì œì–´íŒ â†’ ë¡œê·¸ì¸ í¬í„¸ â†’ ê³ ê¸‰ â†’ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ**
3. **ìƒˆ ê·œì¹™ ì¶”ê°€**:
   - **ì„¤ëª…**: n8n Service
   - **ì†ŒìŠ¤**:
     - í”„ë¡œí† ì½œ: HTTPS
     - í˜¸ìŠ¤íŠ¸ ì´ë¦„: n8n.crossman.synology.me
     - í¬íŠ¸: 443
   - **ëŒ€ìƒ**:
     - í”„ë¡œí† ì½œ: HTTP
     - í˜¸ìŠ¤íŠ¸ ì´ë¦„: localhost
     - í¬íŠ¸: 5678

### SSL ì¸ì¦ì„œ ì ìš©
1. **ì œì–´íŒ â†’ ë³´ì•ˆ â†’ ì¸ì¦ì„œ**
2. **Let's Encrypt ì™€ì¼ë“œì¹´ë“œ ì¸ì¦ì„œ ì„ íƒ**
3. **ì„œë¸Œë„ë©”ì¸ì— ì¸ì¦ì„œ í• ë‹¹**

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë¡œê·¸ ê´€ë¦¬

### ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
sudo docker logs -f cpse_n8n

# ìµœê·¼ ë¡œê·¸ í™•ì¸
sudo docker logs cpse_n8n --tail 50

# íŠ¹ì • ì‹œê°„ ì´í›„ ë¡œê·¸
sudo docker logs cpse_n8n --since "2025-07-07T10:00:00"
```

### ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
```bash
# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
sudo docker ps -a | grep cpse_n8n

# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸
sudo docker stats cpse_n8n --no-stream

# ìƒì„¸ ì •ë³´ í™•ì¸
sudo docker inspect cpse_n8n
```

### í¬íŠ¸ ë° ë„¤íŠ¸ì›Œí¬ í™•ì¸
```bash
# í¬íŠ¸ ì‚¬ìš© í™•ì¸
sudo netstat -tulpn | grep 5678

# ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí¬ í™•ì¸
sudo docker network ls
sudo docker network inspect bridge
```

## ğŸ’¾ ë°±ì—… ë° ë³µêµ¬

### ë°ì´í„° ë°±ì—…
```bash
# n8n ë°ì´í„° ë°±ì—… (ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© ê¶Œì¥)
sudo tar -czf /volume1/backup/n8n_backup_$(date +%Y%m%d_%H%M%S).tar.gz \
  -C /volume1/docker n8n

# ì„¤ì • íŒŒì¼ë§Œ ë°±ì—…
sudo cp -r /volume1/docker/n8n /volume1/backup/n8n_config_$(date +%Y%m%d)
```

### ë°ì´í„° ë³µêµ¬
```bash
# ì„œë¹„ìŠ¤ ì¤‘ì§€
sudo docker stop cpse_n8n

# ê¸°ì¡´ ë°ì´í„° ë°±ì—… (ì•ˆì „ì„ ìœ„í•´)
sudo mv /volume1/docker/n8n /volume1/docker/n8n_old

# ë°±ì—…ì—ì„œ ë³µêµ¬
sudo tar -xzf /volume1/backup/n8n_backup_YYYYMMDD_HHMMSS.tar.gz \
  -C /volume1/docker/

# ê¶Œí•œ ì„¤ì •
sudo chown -R crossman:users /volume1/docker/n8n

# ì„œë¹„ìŠ¤ ì‹œì‘
sudo docker start cpse_n8n
```

## ğŸ”§ ì„¤ì • ë³€ê²½

### í™˜ê²½ ë³€ìˆ˜ ë³€ê²½
```bash
# ì»¨í…Œì´ë„ˆ ì¤‘ì§€
sudo docker stop cpse_n8n

# ì»¨í…Œì´ë„ˆ ì‚­ì œ (ë°ì´í„°ëŠ” ë³´ì¡´ë¨)
sudo docker rm cpse_n8n

# ìƒˆ ì„¤ì •ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì¬ìƒì„±
sudo docker run -d \
  --name cpse_n8n \
  --restart unless-stopped \
  -p 5678:5678 \
  -v /volume1/docker/n8n:/home/node/.n8n \
  -e N8N_BASIC_AUTH_ACTIVE=true \
  -e N8N_BASIC_AUTH_USER=ìƒˆì‚¬ìš©ìëª… \
  -e N8N_BASIC_AUTH_PASSWORD=ìƒˆë¹„ë°€ë²ˆí˜¸ \
  # ... ê¸°íƒ€ í™˜ê²½ ë³€ìˆ˜ë“¤
  n8nio/n8n:latest
```

### í¬íŠ¸ ë³€ê²½
1. **docker-compose.yml ìˆ˜ì •** (ê¶Œì¥)
2. **DSM í¬íŠ¸í¬ì›Œë”© ê·œì¹™ ë³€ê²½**
3. **ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì • ì—…ë°ì´íŠ¸**

## ğŸš¨ ë¬¸ì œ í•´ê²°

### ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°
```bash
# ë¡œê·¸ í™•ì¸
sudo docker logs cpse_n8n

# í¬íŠ¸ ì¶©ëŒ í™•ì¸
sudo netstat -tulpn | grep 5678

# ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
df -h /volume1
```

### ì™¸ë¶€ ì ‘ì†ì´ ì•ˆ ë˜ëŠ” ê²½ìš°
```bash
# ë°©í™”ë²½ í™•ì¸
sudo iptables -L | grep 5678

# í¬íŠ¸í¬ì›Œë”© í™•ì¸ (ê³µìœ ê¸° ì„¤ì •)
# DSM ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì • í™•ì¸
```

### ë°ì´í„°ê°€ ì €ì¥ë˜ì§€ ì•ŠëŠ” ê²½ìš°
```bash
# ë³¼ë¥¨ ë§ˆìš´íŠ¸ í™•ì¸
sudo docker inspect cpse_n8n | grep -A 10 "Mounts"

# ê¶Œí•œ í™•ì¸
ls -la /volume1/docker/n8n
sudo chown -R crossman:users /volume1/docker/n8n
```

### ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜
```bash
# ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
free -h
sudo docker stats cpse_n8n

# ë¶ˆí•„ìš”í•œ ì»¨í…Œì´ë„ˆ ì •ë¦¬
sudo docker system prune -f
```

## ğŸ”„ ì—…ë°ì´íŠ¸ ì ˆì°¨

### n8n ë²„ì „ ì—…ë°ì´íŠ¸
```bash
# í˜„ì¬ ë²„ì „ í™•ì¸
sudo docker exec cpse_n8n n8n --version

# ë°ì´í„° ë°±ì—… (í•„ìˆ˜!)
sudo tar -czf /volume1/backup/n8n_before_update_$(date +%Y%m%d).tar.gz \
  -C /volume1/docker n8n

# ìƒˆ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
sudo docker pull n8nio/n8n:latest

# ì»¨í…Œì´ë„ˆ ì¬ìƒì„±
sudo docker stop cpse_n8n
sudo docker rm cpse_n8n
# ìœ„ì˜ "ì»¨í…Œì´ë„ˆ ìƒì„± ë° ì‹¤í–‰" ëª…ë ¹ ì¬ì‹¤í–‰

# ì •ìƒ ë™ì‘ í™•ì¸
sudo docker logs cpse_n8n
curl -u crossman:changeme123 http://192.168.0.5:5678
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### ë¦¬ì†ŒìŠ¤ ì œí•œ ì„¤ì •
```bash
sudo docker update --memory="1g" --cpus="1.0" cpse_n8n
```

### ë¡œê·¸ í¬ê¸° ì œí•œ
```bash
# docker-compose.ymlì— ì¶”ê°€
logging:
  driver: "json-file"
  options:
    max-size: "50m"
    max-file: "3"
```

## ğŸ“ ì‘ê¸‰ ì—°ë½ì²˜ ë° ì§€ì›

### ë¡œê·¸ íŒŒì¼ ìœ„ì¹˜
- **ì»¨í…Œì´ë„ˆ ë¡œê·¸**: `sudo docker logs cpse_n8n`
- **n8n ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸**: `/volume1/docker/n8n/logs/`
- **DSM ì‹œìŠ¤í…œ ë¡œê·¸**: DSM â†’ ë¡œê·¸ ì„¼í„°

### ì£¼ìš” ì ‘ì† ì •ë³´
- **NAS SSH**: ssh -p 22022 crossman@192.168.0.5
- **DSM ì›¹**: https://192.168.0.5:5001
- **n8n ì„œë¹„ìŠ¤**: https://n8n.crossman.synology.me
- **ë‚´ë¶€ ì§ì ‘ ì ‘ì†**: http://192.168.0.5:5678

### ì‘ê¸‰ ë³µêµ¬ ëª…ë ¹ì–´
```bash
# ì„œë¹„ìŠ¤ ê°•ì œ ì¬ì‹œì‘
sudo docker kill cpse_n8n
sudo docker start cpse_n8n

# ê¸´ê¸‰ ë°±ì—…ì—ì„œ ë³µêµ¬
sudo docker stop cpse_n8n
sudo rm -rf /volume1/docker/n8n
sudo tar -xzf /volume1/backup/n8n_emergency_backup.tar.gz -C /volume1/docker/
sudo chown -R crossman:users /volume1/docker/n8n
sudo docker start cpse_n8n
```

---

**ì‘ì„±ì**: DCEC Development Team  
**ìµœì¢… ìˆ˜ì •**: 2025-07-07 12:11:42  
**ë²„ì „**: 1.0  
**ë¬¸ì„œ ê²½ë¡œ**: `c:\dev\DCEC\docs\CPSE_n8n_manual_20250707121142.md`
